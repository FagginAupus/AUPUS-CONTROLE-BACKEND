{"version":3,"file":"static/js/558.cfe9209d.chunk.js","mappings":"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","sources":["services/pdfGenerator.js"],"sourcesContent":["// src/services/pdfGenerator.js - GERADOR DE PDF VIA HTML COM IMAGENS EMBEDADAS\nimport React from 'react';\nimport { renderToStaticMarkup } from 'react-dom/server';\nimport { Globe, Mail, Smartphone } from 'lucide-react';\n\nclass PDFGenerator {\n  constructor() {\n    this.initialized = true;\n    this.imagensBase64 = {}; // Cache de imagens em Base64\n  }\n\n  // Renderizar √≠cone Lucide React como SVG string\n  getIconSVG(iconName) {\n    try {\n      let IconComponent;\n\n      switch(iconName) {\n        case 'globe':\n          IconComponent = Globe;\n          break;\n        case 'mail':\n          IconComponent = Mail;\n          break;\n        case 'phone':\n          IconComponent = Smartphone;\n          break;\n        default:\n          return '';\n      }\n\n      // Renderizar o componente React como string HTML\n      const svgString = renderToStaticMarkup(\n        React.createElement(IconComponent, {\n          size: 16,\n          color: '#2c3e50',\n          strokeWidth: 2\n        })\n      );\n\n      return svgString;\n    } catch (error) {\n      console.error('Erro ao renderizar √≠cone:', error);\n      // Fallback para emoji se falhar\n      const fallbacks = {\n        globe: 'üåê',\n        mail: '‚úâÔ∏è',\n        phone: 'üì±'\n      };\n      return fallbacks[iconName] || '';\n    }\n  }\n\n  // Calcular fator de escala baseado no n√∫mero de UCs\n  calcularScaleFactor(numUCs) {\n    // Escala progressiva MUITO conservadora para garantir que SEMPRE cabe em 1 p√°gina\n    // IMPORTANTE: Valores m√≠nimos para n√£o estourar a p√°gina\n    // 1-3 UCs: 1.05x (apenas 5% maior)\n    // 4-6 UCs: 1.02x (apenas 2% maior)\n    // 7-10 UCs: 1.0x (padr√£o)\n    if (numUCs <= 3) return 1.05;\n    if (numUCs <= 6) return 1.02;\n    return 1.0;\n  }\n\n  // Carregar imagem e converter para Base64\n  async carregarImagemComoBase64(caminho) {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n\n      img.onload = function() {\n        try {\n          const canvas = document.createElement('canvas');\n          canvas.width = img.width;\n          canvas.height = img.height;\n\n          const ctx = canvas.getContext('2d');\n          ctx.drawImage(img, 0, 0);\n\n          // Converter para Base64\n          const dataURL = canvas.toDataURL('image/png');\n          console.log(`‚úÖ Imagem ${caminho} convertida para Base64`);\n          resolve(dataURL);\n        } catch (error) {\n          console.error(`‚ùå Erro ao converter ${caminho}:`, error);\n          reject(error);\n        }\n      };\n\n      img.onerror = () => {\n        console.error(`‚ùå Erro ao carregar imagem: ${caminho}`);\n        reject(new Error(`Falha ao carregar: ${caminho}`));\n      };\n\n      img.src = caminho;\n    });\n  }\n\n  // Carregar todas as imagens necess√°rias\n  async carregarTodasImagens() {\n    try {\n      console.log('üñºÔ∏è Carregando imagens...');\n\n      const [logoBase64, sloganBase64, ondaBase64] = await Promise.all([\n        this.carregarImagemComoBase64('/Logo.png'),\n        this.carregarImagemComoBase64('/Frase_interligando.png'),\n        this.carregarImagemComoBase64('/Onda.png')\n      ]);\n\n      this.imagensBase64 = {\n        logo: logoBase64,\n        slogan: sloganBase64,\n        onda: ondaBase64\n      };\n\n      console.log('‚úÖ Todas as imagens carregadas e convertidas para Base64');\n      return true;\n    } catch (error) {\n      console.warn('‚ö†Ô∏è Erro ao carregar algumas imagens:', error);\n      // Continuar mesmo com erro - usar fallbacks\n      return false;\n    }\n  }\n\n  // Carregar biblioteca html2canvas\n  async loadHtml2Canvas() {\n    if (window.html2canvas) {\n      return true;\n    }\n\n    try {\n      console.log('üì• Carregando html2canvas...');\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';\n        script.onload = resolve;\n        script.onerror = () => reject(new Error('Falha ao carregar html2canvas'));\n        document.head.appendChild(script);\n      });\n      console.log('‚úÖ html2canvas carregado com sucesso');\n      return true;\n    } catch (error) {\n      console.error('‚ùå Erro ao carregar html2canvas:', error);\n      throw new Error('N√£o foi poss√≠vel carregar html2canvas');\n    }\n  }\n\n  // Carregar jsPDF (j√° usado no projeto)\n  async loadJsPDF() {\n    if (window.jspdf) {\n      return true;\n    }\n\n    try {\n      console.log('üì• Carregando jsPDF...');\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';\n        script.onload = resolve;\n        script.onerror = () => reject(new Error('Falha ao carregar jsPDF'));\n        document.head.appendChild(script);\n      });\n      console.log('‚úÖ jsPDF carregado com sucesso');\n      return true;\n    } catch (error) {\n      console.error('‚ùå Erro ao carregar jsPDF:', error);\n      throw new Error('N√£o foi poss√≠vel carregar jsPDF');\n    }\n  }\n\n  // Fun√ß√£o principal para gerar PDF a partir do HTML\n  async gerarHTML(dadosProposta, autoDownload = true) {\n    let iframe = null;\n    let overlay = null;\n\n    try {\n      console.log('üìÑ Iniciando gera√ß√£o de PDF via HTML...', dadosProposta.numeroProposta);\n\n      // Mostrar overlay de loading\n      overlay = document.createElement('div');\n      overlay.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        z-index: 999999;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        color: white;\n        font-size: 20px;\n        font-family: Arial, sans-serif;\n      `;\n      overlay.innerHTML = '<div>üìÑ Gerando PDF...</div>';\n      document.body.appendChild(overlay);\n\n      // Carregar bibliotecas\n      await Promise.all([\n        this.loadJsPDF(),\n        this.loadHtml2Canvas()\n      ]);\n\n      // Carregar imagens\n      await this.carregarTodasImagens();\n\n      // Criar HTML completo\n      const htmlContent = await this.criarLayoutHTML(dadosProposta);\n\n      // Criar iframe invis√≠vel\n      iframe = document.createElement('iframe');\n      iframe.style.cssText = `\n        position: fixed;\n        top: -10000px;\n        left: -10000px;\n        width: 210mm;\n        height: 297mm;\n        border: none;\n        background: white;\n      `;\n      document.body.appendChild(iframe);\n\n      // Escrever HTML no iframe\n      const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\n      iframeDoc.open();\n      iframeDoc.write(htmlContent);\n      iframeDoc.close();\n\n      console.log('üì∏ Aguardando renderiza√ß√£o...');\n      await new Promise(resolve => setTimeout(resolve, 1000));\n\n      const pageContainer = iframeDoc.querySelector('.page-container');\n      if (!pageContainer) {\n        throw new Error('Elemento .page-container n√£o encontrado');\n      }\n\n      console.log('üì∏ Capturando HTML como imagem...');\n\n      // Capturar usando html2canvas\n      const canvas = await window.html2canvas(pageContainer, {\n        scale: 2,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff',\n        logging: false\n      });\n\n      console.log('‚úÖ Captura conclu√≠da. Gerando PDF...');\n\n      // Criar PDF\n      const { jsPDF } = window.jspdf;\n      const pdf = new jsPDF({\n        orientation: 'portrait',\n        unit: 'mm',\n        format: 'a4',\n        compress: true\n      });\n\n      // Calcular dimens√µes\n      const imgWidth = 210;\n      const imgHeight = (canvas.height * imgWidth) / canvas.width;\n\n      // Adicionar imagem\n      const imgData = canvas.toDataURL('image/jpeg', 0.95);\n      pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);\n\n      // Nome do arquivo\n      const nomeArquivo = this.gerarNomeArquivo(dadosProposta);\n\n      // Baixar\n      if (autoDownload) {\n        pdf.save(nomeArquivo);\n        console.log('‚úÖ PDF baixado:', nomeArquivo);\n      }\n\n      // Limpar\n      if (iframe && document.body.contains(iframe)) {\n        document.body.removeChild(iframe);\n      }\n      if (overlay && document.body.contains(overlay)) {\n        document.body.removeChild(overlay);\n      }\n\n      return {\n        nomeArquivo,\n        pdfBlob: pdf.output('blob'),\n        success: true\n      };\n\n    } catch (error) {\n      console.error('‚ùå Erro ao gerar PDF:', error);\n\n      // Limpar em caso de erro\n      if (iframe && document.body.contains(iframe)) {\n        document.body.removeChild(iframe);\n      }\n      if (overlay && document.body.contains(overlay)) {\n        document.body.removeChild(overlay);\n      }\n\n      throw error;\n    }\n  }\n\n  // Criar layout HTML completo\n  async criarLayoutHTML(dados) {\n    // Calcular n√∫mero de UCs para responsividade\n    const numUCs = dados.ucs ? dados.ucs.length : 0;\n    const scaleFactor = this.calcularScaleFactor(numUCs);\n\n    const html = `<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Proposta ${dados.numeroProposta} - ${dados.nomeCliente}</title>\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n\n    body {\n      font-family: 'Helvetica', 'Arial', sans-serif;\n      background: white;\n      color: #3c3c3c;\n      padding: 0;\n      margin: 0;\n    }\n\n    /* CSS Responsivo baseado em ${numUCs} UCs - Scale: ${scaleFactor.toFixed(2)} */\n    :root {\n      --scale-factor: ${scaleFactor};\n    }\n\n    .page-container {\n      width: 210mm;\n      min-height: 297mm;\n      margin: 0 auto;\n      background: white;\n      position: relative;\n      padding: 0;\n      padding-bottom: 70px; /* Espa√ßo para rodap√© - REDUZIDO */\n      border: 0; /* SEM BORDAS */\n      border-top: 15px solid #2c3e50; /* APENAS BORDA SUPERIOR */\n    }\n\n    /* Cabe√ßalho - RESPONSIVO */\n    .header {\n      background: #2c3e50;\n      padding: calc(8px * var(--scale-factor)) 20px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      height: calc(45px * var(--scale-factor));\n    }\n\n    .header img {\n      height: calc(38px * var(--scale-factor));\n      width: auto;\n    }\n\n    .header h1 {\n      color: white;\n      font-size: calc(15px * var(--scale-factor));\n      font-weight: bold;\n      margin-left: 15px;\n    }\n\n    /* Se√ß√µes - RESPONSIVAS */\n    .section {\n      padding: calc(8px * var(--scale-factor)) calc(25px * var(--scale-factor)) calc(10px * var(--scale-factor)) calc(25px * var(--scale-factor));\n      border-bottom: 1px solid #d0d0d0;\n    }\n\n    .section-title {\n      font-size: calc(13px * var(--scale-factor));\n      font-weight: bold;\n      color: #2c3e50;\n      margin-bottom: calc(6px * var(--scale-factor));\n      padding-bottom: calc(4px * var(--scale-factor));\n      border-bottom: 2px solid #4caf50;\n      display: inline-block;\n      padding-right: 15px;\n    }\n\n    /* Informa√ß√µes do Cliente - RESPONSIVO */\n    .client-info {\n      display: flex;\n      gap: calc(25px * var(--scale-factor));\n      font-size: calc(10px * var(--scale-factor));\n      margin-top: calc(4px * var(--scale-factor));\n      background: #f8f9fa;\n      padding: calc(8px * var(--scale-factor)) calc(12px * var(--scale-factor));\n      border-radius: 3px;\n      border-left: 3px solid #2c3e50;\n    }\n\n    .client-info .field {\n      display: flex;\n      gap: 6px;\n      align-items: center;\n    }\n\n    .client-info .label {\n      font-weight: bold;\n      color: #2c3e50;\n    }\n\n    .client-info .field span:not(.label) {\n      color: #444;\n    }\n\n    /* Plano Economia - RESPONSIVO */\n    .economy-plan {\n      display: flex;\n      align-items: center;\n      gap: calc(40px * var(--scale-factor));\n      margin-top: calc(4px * var(--scale-factor));\n      background: linear-gradient(135deg, #f0f9f4 0%, #e8f5e9 100%);\n      padding: calc(10px * var(--scale-factor)) calc(15px * var(--scale-factor));\n      border-radius: 4px;\n      border: 2px solid #4caf50;\n    }\n\n    .economy-value {\n      display: flex;\n      align-items: center;\n      gap: calc(10px * var(--scale-factor));\n    }\n\n    .economy-value .label {\n      font-weight: bold;\n      font-size: calc(11px * var(--scale-factor));\n      color: #2c3e50;\n    }\n\n    .economy-value .value {\n      font-size: calc(26px * var(--scale-factor));\n      font-weight: bold;\n      color: #2e7d32;\n      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);\n    }\n\n    .fidelity {\n      display: flex;\n      align-items: center;\n      gap: calc(8px * var(--scale-factor));\n      background: white;\n      padding: calc(6px * var(--scale-factor)) calc(12px * var(--scale-factor));\n      border-radius: 3px;\n      border: 1px solid #ddd;\n    }\n\n    .fidelity .label {\n      font-weight: bold;\n      font-size: calc(11px * var(--scale-factor));\n      color: #2c3e50;\n    }\n\n    .fidelity .value {\n      font-size: calc(12px * var(--scale-factor));\n      font-weight: bold;\n      color: #d32f2f;\n    }\n\n    /* Tabela de UCs - RESPONSIVA */\n    .uc-table {\n      width: 100%;\n      border-collapse: collapse;\n      margin-top: calc(6px * var(--scale-factor));\n      font-size: calc(9px * var(--scale-factor));\n      table-layout: fixed;\n    }\n\n    .uc-table thead {\n      background: #46648a;\n      color: white;\n    }\n\n    .uc-table th {\n      padding: calc(5px * var(--scale-factor)) calc(3px * var(--scale-factor));\n      text-align: left;\n      font-weight: bold;\n      font-size: calc(8px * var(--scale-factor));\n    }\n\n    /* Larguras espec√≠ficas das colunas */\n    .uc-table th:nth-child(1),\n    .uc-table td:nth-child(1) {\n      width: 22%; /* Nome - AUMENTADO */\n    }\n\n    .uc-table th:nth-child(2),\n    .uc-table td:nth-child(2) {\n      width: 13%; /* Consumo - REDUZIDO */\n    }\n\n    .uc-table th:nth-child(3),\n    .uc-table td:nth-child(3) {\n      width: 12%; /* Sem Assinatura - REDUZIDO */\n    }\n\n    .uc-table th:nth-child(4),\n    .uc-table td:nth-child(4) {\n      width: 12%; /* Com Assinatura - REDUZIDO */\n    }\n\n    .uc-table th:nth-child(5),\n    .uc-table td:nth-child(5) {\n      width: 10%; /* Taxa Fixa - REDUZIDO */\n    }\n\n    .uc-table th:nth-child(6),\n    .uc-table td:nth-child(6) {\n      width: 15%; /* Economia Mensal */\n    }\n\n    .uc-table th:nth-child(7),\n    .uc-table td:nth-child(7) {\n      width: 16%; /* Economia Anual */\n    }\n\n    .uc-table tbody tr:nth-child(even) {\n      background: #f8f8f8;\n    }\n\n    .uc-table td {\n      padding: calc(4px * var(--scale-factor)) calc(3px * var(--scale-factor));\n      font-size: calc(9px * var(--scale-factor));\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    /* Gr√°fico Economia 5 Anos - RESPONSIVO */\n    .chart-container {\n      margin-top: calc(8px * var(--scale-factor));\n      background: linear-gradient(to bottom, #f5f5f5 0%, #fafafa 100%);\n      padding: calc(12px * var(--scale-factor));\n      border-radius: 4px;\n      border: 1px solid #e0e0e0;\n      box-shadow: 0 1px 3px rgba(0,0,0,0.05);\n    }\n\n    .bars-container {\n      display: flex;\n      justify-content: space-around;\n      align-items: flex-end;\n      height: calc(140px * var(--scale-factor));\n      margin-bottom: calc(10px * var(--scale-factor));\n      position: relative;\n      border-bottom: 2px solid #2c3e50;\n      padding-bottom: calc(8px * var(--scale-factor));\n    }\n\n    .bar-wrapper {\n      text-align: center;\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: flex-end;\n      height: 100%;\n    }\n\n    .bar {\n      background: linear-gradient(to top, #1e3a5f 0%, #2c3e50 100%);\n      border: 2px solid #1e324a;\n      width: 75%;\n      position: relative;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border-radius: 4px 4px 0 0;\n      box-shadow: 0 -2px 8px rgba(0,0,0,0.15);\n      transition: all 0.3s ease;\n      /* Altura definida inline para cada barra */\n    }\n\n    .bar-value {\n      color: white;\n      font-weight: bold;\n      font-size: calc(9px * var(--scale-factor));\n      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);\n    }\n\n    .bar-label {\n      margin-top: calc(6px * var(--scale-factor));\n      font-weight: bold;\n      font-size: calc(10px * var(--scale-factor));\n      color: #2c3e50;\n      background: white;\n      padding: calc(3px * var(--scale-factor)) calc(6px * var(--scale-factor));\n      border-radius: 3px;\n      border: 1px solid #ddd;\n    }\n\n    .total-economy {\n      font-size: calc(13px * var(--scale-factor));\n      font-weight: bold;\n      color: #2e7d32;\n      text-align: center;\n      margin-top: calc(10px * var(--scale-factor));\n      padding: calc(8px * var(--scale-factor));\n      background: white;\n      border-radius: 4px;\n      border: 2px solid #4caf50;\n    }\n\n    /* Benef√≠cios - RESPONSIVO */\n    .benefits-list {\n      margin-top: calc(6px * var(--scale-factor));\n      padding-left: calc(18px * var(--scale-factor));\n    }\n\n    .benefits-list li {\n      margin-bottom: calc(4px * var(--scale-factor));\n      font-size: calc(10px * var(--scale-factor));\n      line-height: 1.4;\n    }\n\n    /* Rodap√© */\n    .footer {\n      position: absolute;\n      bottom: 25px;\n      left: 40px;\n      right: 40px;\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-end;\n      font-size: 11px;\n    }\n\n    .footer-contacts {\n      text-align: left;\n    }\n\n    .footer-contacts p {\n      margin: 4px 0;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n\n    .footer-contacts svg {\n      width: 16px;\n      height: 16px;\n      flex-shrink: 0;\n      vertical-align: middle;\n    }\n\n    .footer-slogan {\n      text-align: center;\n      flex: 1;\n    }\n\n    .footer-slogan img {\n      max-width: 350px;\n      height: auto;\n    }\n\n    .footer-wave {\n      text-align: right;\n    }\n\n    .footer-wave img {\n      max-width: 100px;\n      height: auto;\n    }\n\n    @media print {\n      .page-container {\n        border: 12px solid #2c3e50;\n        margin: 0;\n        width: 210mm;\n        min-height: 297mm;\n      }\n\n      body {\n        margin: 0;\n        padding: 0;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"page-container\">\n\n    <!-- Cabe√ßalho -->\n    <div class=\"header\">\n      ${this.imagensBase64.logo\n        ? `<img src=\"${this.imagensBase64.logo}\" alt=\"AUPUS Logo\">`\n        : '<div style=\"color: white; font-weight: bold; font-size: 16px;\">AUPUS</div>'\n      }\n      <h1>Proje√ß√£o de efici√™ncia econ√¥mica</h1>\n    </div>\n\n    <!-- Informa√ß√µes do Cliente -->\n    <div class=\"section\">\n      <div class=\"section-title\">Cliente</div>\n      <div class=\"client-info\">\n        <div class=\"field\">\n          <span class=\"label\">Nome:</span>\n          <span>${dados.nomeCliente || ''}</span>\n        </div>\n        <div class=\"field\">\n          <span class=\"label\">Proposta:</span>\n          <span>${dados.numeroProposta || ''}</span>\n        </div>\n        <div class=\"field\">\n          <span class=\"label\">Data:</span>\n          <span>${this.formatarData(dados.data)}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Plano Economia -->\n    <div class=\"section\">\n      <div class=\"section-title\">Plano Economia</div>\n      <div class=\"economy-plan\">\n        <div class=\"economy-value\">\n          <span class=\"label\">Economia Esperada:</span>\n          <span class=\"value\">${this.calcularDescontoPercentual(dados.descontoTarifa)}%</span>\n        </div>\n        <div class=\"fidelity\">\n          <span class=\"label\">Fidelidade:</span>\n          <span class=\"value\">N√ÉO</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Tabela de Unidades Consumidoras -->\n    ${this.gerarTabelaUCs(dados.ucs, dados.tarifaTributos, dados.descontoTarifa)}\n\n    <!-- Gr√°fico Economia 5 Anos -->\n    ${this.gerarGraficoEconomia(dados)}\n\n    <!-- Benef√≠cios -->\n    ${this.gerarBeneficios(dados.beneficios)}\n\n    <!-- Rodap√© -->\n    <div class=\"footer\">\n      <div class=\"footer-contacts\">\n        <p>${this.getIconSVG('globe')} www.aupusenergia.com.br</p>\n        <p>${this.getIconSVG('mail')} smart@aupusenergia.com.br</p>\n        <p>${this.getIconSVG('phone')} (62) 9 9654-7888</p>\n      </div>\n      <div class=\"footer-slogan\">\n        ${this.imagensBase64.slogan\n          ? `<img src=\"${this.imagensBase64.slogan}\" alt=\"Interligando voc√™ com o futuro!\">`\n          : '<p style=\"color: #4caf50; font-style: italic; font-size: 14px;\">Interligando voc√™ com o futuro!</p>'\n        }\n      </div>\n      <div class=\"footer-wave\">\n        ${this.imagensBase64.onda\n          ? `<img src=\"${this.imagensBase64.onda}\" alt=\"Onda\">`\n          : ''\n        }\n      </div>\n    </div>\n\n  </div>\n</body>\n</html>`;\n\n    return html;\n  }\n\n  // Gerar tabela de UCs\n  gerarTabelaUCs(ucs, tarifaTributos, descontoTarifa) {\n    if (!ucs || ucs.length === 0) return '';\n\n    const maxLinhas = 18;\n    const ucsParaMostrar = ucs.slice(0, maxLinhas);\n\n    let html = `\n    <div class=\"section\">\n      <div class=\"section-title\">Unidades Consumidoras</div>\n      <table class=\"uc-table\">\n        <thead>\n          <tr>\n            <th>Nome</th>\n            <th>Consumo</th>\n            <th>Sem<br>Assinatura</th>\n            <th>Com<br>Assinatura</th>\n            <th>Taxa<br>Fixa</th>\n            <th>Economia<br>Mensal</th>\n            <th>Economia<br>Anual</th>\n          </tr>\n        </thead>\n        <tbody>`;\n\n    ucsParaMostrar.forEach((uc, index) => {\n      const consumo = parseFloat(uc.consumo) || 0;\n      const tarifa = parseFloat(tarifaTributos) || 0.8;\n      const desconto = parseFloat(descontoTarifa) || 0.2;\n\n      const semAssinatura = consumo * tarifa;\n      const economiaMensal = consumo * tarifa * desconto;\n      const economiaAnual = economiaMensal * 12;\n      const comAssinatura = consumo * tarifa * (1 - desconto);\n      const taxaFixa = this.calcularTaxaFixa(uc.ligacao);\n\n      const nomeUC = (uc.apelido || `UC ${index + 1}`).substring(0, 25); // AUMENTADO de 12 para 25\n\n      // Formatar valores em reais com separadores de milhares\n      const formatarReais = (valor) => {\n        return valor.toLocaleString('pt-BR', {\n          minimumFractionDigits: 2,\n          maximumFractionDigits: 2\n        });\n      };\n\n      html += `\n          <tr>\n            <td>${nomeUC}</td>\n            <td>${consumo.toFixed(0)} kWh</td>\n            <td>R$ ${formatarReais(semAssinatura)}</td>\n            <td>R$ ${formatarReais(comAssinatura)}</td>\n            <td>R$ ${formatarReais(taxaFixa)}</td>\n            <td>R$ ${formatarReais(economiaMensal)}</td>\n            <td>R$ ${formatarReais(economiaAnual)}</td>\n          </tr>`;\n    });\n\n    html += `\n        </tbody>\n      </table>`;\n\n    if (ucs.length > maxLinhas) {\n      html += `<p style=\"color: #b40000; font-size: 10px; margin-top: 5px;\">+ ${ucs.length - maxLinhas} unidades adicionais</p>`;\n    }\n\n    html += `</div>`;\n\n    return html;\n  }\n\n  // Calcular taxa fixa\n  calcularTaxaFixa(ligacao) {\n    switch (ligacao?.toUpperCase()) {\n      case 'TRIF√ÅSICA':\n      case 'TRIFASICA':\n        return 112;\n      case 'BIF√ÅSICA':\n      case 'BIFASICA':\n        return 62;\n      case 'MONOF√ÅSICA':\n      case 'MONOFASICA':\n      default:\n        return 42;\n    }\n  }\n\n  // Gerar gr√°fico de economia 5 anos - CORRIGIDO COM LIMITE E MODERA√á√ÉO E RESPONSIVO\n  gerarGraficoEconomia(dados) {\n    if (!dados.ucs || dados.ucs.length === 0 || !dados.tarifaTributos) {\n      return '';\n    }\n\n    const economiaData = this.calcularEconomiaConsolidada(\n      dados.ucs,\n      dados.tarifaTributos,\n      dados.descontoTarifa,\n      dados.inflacao\n    );\n\n    // Calcular scale factor para responsividade\n    const numUCs = dados.ucs ? dados.ucs.length : 0;\n    const scaleFactor = this.calcularScaleFactor(numUCs);\n\n    const valorMaximo = Math.max(...economiaData.economiasPorAno);\n    const valorMinimo = Math.min(...economiaData.economiasPorAno);\n    const alturaContainer = 140 * scaleFactor; // pixels - responsivo baseado em UCs\n    const alturaMinima = 30 * scaleFactor; // pixels - altura m√≠nima da barra (responsiva)\n    const alturaMaximaPermitida = alturaContainer - (10 * scaleFactor); // Deixar margem no topo\n\n    let html = `\n    <div class=\"section\">\n      <div class=\"section-title\">Economia nos pr√≥ximos cinco anos</div>\n      <div class=\"chart-container\">\n        <div class=\"bars-container\">`;\n\n    economiaData.economiasPorAno.forEach((valor, index) => {\n      // Calcular altura proporcional com diferen√ßa moderada\n      const espacoDisponivel = alturaMaximaPermitida - alturaMinima;\n\n      // Normalizar valores com dampening para moderar a diferen√ßa visual\n      // 40% base + 60% vari√°vel = diferen√ßa mais suave entre anos\n      const range = valorMaximo - valorMinimo;\n      const valorNormalizado = range > 0 ? (valor - valorMinimo) / range : 0;\n      const valorDampened = 0.4 + (valorNormalizado * 0.6); // Dampening factor\n\n      const alturaRelativa = valorDampened * espacoDisponivel;\n      const alturaFinal = Math.min(alturaMinima + alturaRelativa, alturaMaximaPermitida); // Garantir que n√£o ultrapassa\n\n      // Log para debug\n      console.log(`Ano ${index + 1}: Valor=${valor}, AlturaFinal=${alturaFinal}px (max: ${alturaMaximaPermitida}px)`);\n\n      const valorFormatado = valor.toLocaleString('pt-BR', {\n        style: 'currency',\n        currency: 'BRL',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n      });\n\n      html += `\n          <div class=\"bar-wrapper\">\n            <div class=\"bar\" style=\"height: ${alturaFinal}px !important; min-height: ${alturaFinal}px !important; max-height: ${alturaFinal}px !important;\">\n              <span class=\"bar-value\">${valorFormatado}</span>\n            </div>\n            <div class=\"bar-label\">Ano ${index + 1}</div>\n          </div>`;\n    });\n\n    const economiaFormatada = economiaData.economiaTotal.toLocaleString('pt-BR', {\n      style: 'currency',\n      currency: 'BRL',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    });\n\n    html += `\n        </div>\n        <div class=\"total-economy\">Economia Total: ${economiaFormatada}</div>\n      </div>\n    </div>`;\n\n    return html;\n  }\n\n  // Calcular economia consolidada\n  calcularEconomiaConsolidada(ucs, tarifaTributos, descontoTarifa, inflacao) {\n    const economiasConsolidadas = Array(5).fill(0);\n\n    ucs.forEach(uc => {\n      const economiaUC = this.calcularEconomia5Anos(uc, tarifaTributos, descontoTarifa, inflacao);\n      economiaUC.forEach((valor, index) => {\n        economiasConsolidadas[index] += valor;\n      });\n    });\n\n    return {\n      economiasPorAno: economiasConsolidadas,\n      economiaTotal: economiasConsolidadas.reduce((total, valor) => total + valor, 0)\n    };\n  }\n\n  // Calcular economia por UC para 5 anos\n  calcularEconomia5Anos(uc, tarifaTributos, descontoTarifa, inflacao) {\n    const consumo = parseFloat(uc.consumo) || 0;\n    const tarifa = parseFloat(tarifaTributos) || 0.8;\n    const desconto = parseFloat(descontoTarifa) || 0.2;\n    const inflacaoDecimal = parseFloat(inflacao) || 0.02;\n\n    if (consumo === 0 || tarifa === 0) {\n      return Array(5).fill(0);\n    }\n\n    const economiaMensal = consumo * tarifa * desconto;\n    const economias = [];\n    let economiaAno = economiaMensal * 12;\n\n    for (let ano = 1; ano <= 5; ano++) {\n      economias.push(economiaAno);\n      economiaAno = economiaAno * (1 + inflacaoDecimal);\n    }\n\n    return economias;\n  }\n\n  // Gerar benef√≠cios\n  gerarBeneficios(beneficios) {\n    if (!beneficios || beneficios.length === 0) {\n      return '';\n    }\n\n    const maxBeneficios = 10;\n    const beneficiosParaMostrar = beneficios.slice(0, maxBeneficios);\n\n    let html = `\n    <div class=\"section\">\n      <div class=\"section-title\">Informa√ß√µes e Benef√≠cios</div>\n      <ul class=\"benefits-list\">`;\n\n    beneficiosParaMostrar.forEach((beneficio, index) => {\n      const numero = beneficio.numero || index + 1;\n      const texto = beneficio.texto || beneficio.toString();\n      html += `<li>${numero}. ${texto}</li>`;\n    });\n\n    html += `</ul>`;\n\n    if (beneficios.length > maxBeneficios) {\n      html += `<p style=\"color: #b40000; font-size: 10px; margin-top: 5px;\">+ ${beneficios.length - maxBeneficios} benef√≠cios adicionais</p>`;\n    }\n\n    html += `</div>`;\n\n    return html;\n  }\n\n  // Formatar data - corrigido para evitar problemas de timezone\n  formatarData(data) {\n    if (!data) return '';\n    try {\n      // Extrair apenas a parte da data (YYYY-MM-DD) ignorando timezone\n      const dataString = data.toString();\n\n      // Se a data estiver no formato ISO (YYYY-MM-DD ou YYYY-MM-DDTHH:mm:ss)\n      if (dataString.includes('-')) {\n        const [ano, mes, dia] = dataString.split('T')[0].split('-');\n        return `${dia.padStart(2, '0')}/${mes.padStart(2, '0')}/${ano}`;\n      }\n\n      // Fallback para formato padr√£o\n      return new Date(data).toLocaleDateString('pt-BR');\n    } catch (error) {\n      console.error('Erro ao formatar data:', error);\n      return '';\n    }\n  }\n\n  // Calcular desconto percentual\n  calcularDescontoPercentual(desconto) {\n    return Math.round((desconto || 0.2) * 100);\n  }\n\n  // Gerar nome do arquivo\n  gerarNomeArquivo(dados) {\n    const proposta = dados.numeroProposta?.replace(/[/\\\\]/g, '_') || 'Proposta';\n    const cliente = dados.nomeCliente?.replace(/[^a-zA-Z0-9]/g, '_') || 'Cliente';\n    const timestamp = new Date().toISOString().slice(0, 10);\n\n    return `${proposta}_${cliente}_${timestamp}.pdf`;\n  }\n\n  // Formatar dados para HTML\n  formatarDadosParaHTML(proposta) {\n    return {\n      numeroProposta: proposta.numero_proposta || proposta.numeroProposta,\n      nomeCliente: proposta.nome_cliente || proposta.nomeCliente,\n      consultor: proposta.consultor,\n      data: proposta.data_proposta || proposta.data,\n      descontoTarifa: parseFloat(proposta.desconto_tarifa || proposta.descontoTarifa) || 0.2,\n      descontoBandeira: parseFloat(proposta.desconto_bandeira || proposta.descontoBandeira) || 0.2,\n      tarifaTributos: parseFloat(proposta.tarifa_tributos || proposta.tarifaTributos) || 0.8,\n      inflacao: parseFloat(proposta.inflacao) || 0.02,\n      observacoes: proposta.observacoes || '',\n      ucs: this.formatarUCs(proposta.unidades_consumidoras || proposta.ucs || []),\n      beneficios: this.formatarBeneficios(proposta.beneficios || [])\n    };\n  }\n\n  // Formatar UCs para HTML\n  formatarUCs(ucs) {\n    if (typeof ucs === 'string') {\n      try {\n        ucs = JSON.parse(ucs);\n      } catch (e) {\n        return [];\n      }\n    }\n\n    if (!Array.isArray(ucs)) return [];\n\n    return ucs.map(uc => ({\n      apelido: uc.apelido || uc.numero_unidade || 'UC',\n      numeroUC: uc.numero_unidade || uc.numeroUC || '',\n      ligacao: uc.ligacao || uc.tipo_ligacao || 'Monof√°sica',\n      consumo: uc.consumo_medio || uc.consumo || 0\n    }));\n  }\n\n  // Formatar benef√≠cios para HTML\n  formatarBeneficios(beneficios) {\n    if (typeof beneficios === 'string') {\n      try {\n        beneficios = JSON.parse(beneficios);\n      } catch (e) {\n        return [];\n      }\n    }\n\n    if (!Array.isArray(beneficios)) return [];\n\n    return beneficios.map((beneficio, index) => ({\n      numero: beneficio.numero || (index + 1),\n      texto: beneficio.texto || beneficio.toString()\n    }));\n  }\n\n  // M√©todos est√°ticos\n  static async baixarPDF(dadosProposta, autoDownload = true) {\n    const generator = new PDFGenerator();\n    return await generator.gerarHTML(dadosProposta, autoDownload);\n  }\n\n  static async baixarPDFDeProposta(proposta, autoDownload = true) {\n    const generator = new PDFGenerator();\n    const dadosFormatados = generator.formatarDadosParaHTML(proposta);\n    return await generator.gerarHTML(dadosFormatados, autoDownload);\n  }\n}\n\n// Exportar para uso em outros arquivos\nexport default PDFGenerator;\n\n// Disponibilizar globalmente para compatibilidade\nif (typeof window !== 'undefined') {\n  window.PDFGenerator = PDFGenerator;\n}\n"],"names":["PDFGenerator","constructor","this","initialized","imagensBase64","getIconSVG","iconName","IconComponent","Globe","Mail","Smartphone","renderToStaticMarkup","React","size","color","strokeWidth","error","console","globe","mail","phone","calcularScaleFactor","numUCs","carregarImagemComoBase64","caminho","Promise","resolve","reject","img","Image","crossOrigin","onload","canvas","document","createElement","width","height","getContext","drawImage","dataURL","toDataURL","log","concat","onerror","Error","src","carregarTodasImagens","logoBase64","sloganBase64","ondaBase64","all","logo","slogan","onda","warn","loadHtml2Canvas","window","html2canvas","script","head","appendChild","loadJsPDF","jspdf","gerarHTML","dadosProposta","autoDownload","arguments","length","undefined","iframe","overlay","numeroProposta","style","cssText","innerHTML","body","htmlContent","criarLayoutHTML","iframeDoc","contentDocument","contentWindow","open","write","close","setTimeout","pageContainer","querySelector","scale","useCORS","allowTaint","backgroundColor","logging","jsPDF","pdf","orientation","unit","format","compress","imgWidth","imgHeight","imgData","addImage","nomeArquivo","gerarNomeArquivo","save","contains","removeChild","pdfBlob","output","success","dados","ucs","scaleFactor","nomeCliente","toFixed","formatarData","data","calcularDescontoPercentual","descontoTarifa","gerarTabelaUCs","tarifaTributos","gerarGraficoEconomia","gerarBeneficios","beneficios","ucsParaMostrar","slice","html","forEach","uc","index","consumo","parseFloat","tarifa","desconto","semAssinatura","economiaMensal","economiaAnual","comAssinatura","taxaFixa","calcularTaxaFixa","ligacao","nomeUC","apelido","substring","formatarReais","valor","toLocaleString","minimumFractionDigits","maximumFractionDigits","toUpperCase","economiaData","calcularEconomiaConsolidada","inflacao","valorMaximo","Math","max","economiasPorAno","valorMinimo","min","alturaMinima","alturaMaximaPermitida","range","alturaRelativa","alturaFinal","valorFormatado","currency","economiaFormatada","economiaTotal","economiasConsolidadas","Array","fill","calcularEconomia5Anos","reduce","total","inflacaoDecimal","economias","economiaAno","ano","push","beneficiosParaMostrar","beneficio","numero","texto","toString","dataString","includes","mes","dia","split","padStart","Date","toLocaleDateString","round","_dados$numeroProposta","_dados$nomeCliente","proposta","replace","cliente","timestamp","toISOString","formatarDadosParaHTML","numero_proposta","nome_cliente","consultor","data_proposta","desconto_tarifa","descontoBandeira","desconto_bandeira","tarifa_tributos","observacoes","formatarUCs","unidades_consumidoras","formatarBeneficios","JSON","parse","e","isArray","map","numero_unidade","numeroUC","tipo_ligacao","consumo_medio","baixarPDF","generator","baixarPDFDeProposta","dadosFormatados"],"sourceRoot":""}